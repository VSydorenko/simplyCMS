
# План: Прості товари без модифікацій

## Опис завдання

Реалізувати можливість створювати "прості товари" без обов'язкового створення модифікацій. Для простих товарів ціна, наявність і властивості вказуються безпосередньо в картці товару.

## Зміни в базі даних

Додати нові поля до таблиці `products`:

| Поле | Тип | Опис |
|------|-----|------|
| `has_modifications` | boolean | Чи має товар модифікації (false = простий товар) |
| `price` | numeric | Ціна простого товару |
| `old_price` | numeric | Стара ціна (для знижки) |
| `sku` | varchar | Артикул простого товару |
| `stock_quantity` | integer | Кількість на складі |
| `is_in_stock` | boolean | Чи є в наявності |

## Зміни в адмін-панелі

### Сторінка редагування товару (`ProductEdit.tsx`)

1. **Перемикач типу товару** в секції "Налаштування":
   - "Простий товар" / "Товар з модифікаціями"

2. **Для простого товару** відображати:
   - Поля ціни, старої ціни, артикулу, кількості, наявності
   - ВСІ властивості розділу (і "product", і "modification" рівня) об'єднані в одному блоці

3. **Для товару з модифікаціями**:
   - Залишити поточну логіку з таблицею модифікацій

4. **Розділ стає обов'язковим** для заповнення властивостей

### Схема інтерфейсу

```text
+------------------------+
|    НАЛАШТУВАННЯ        |
+------------------------+
| Розділ: [Інвертори ▼]  |
+------------------------+
| ○ Простий товар        |
| ● Товар з модифікаціями|
+------------------------+
| [✓] Активний           |
| [ ] Рекомендований     |
+------------------------+

Для простого товару:
+------------------------+
|    ЦІНА ТА НАЯВНІСТЬ   |
+------------------------+
| Ціна*:    [5000]       |
| Стара ціна: [6000]     |
| Артикул:  [INV-001]    |
| Кількість: [10]        |
| [✓] В наявності        |
+------------------------+

+------------------------+
|    ВЛАСТИВОСТІ         |
+------------------------+
| (Об'єднані product +   |
|  modification рівня)   |
+------------------------+
```

## Зміни в каталозі

### ProductCard

```text
if (product.has_modifications) {
  // Використовувати ціну з першої модифікації (як зараз)
  price = defaultMod?.price
} else {
  // Використовувати ціну безпосередньо з товару
  price = product.price
}
```

### ProductDetail

1. Якщо `has_modifications = false`:
   - Не показувати селектор модифікацій
   - Брати ціну, наявність, артикул з самого товару

2. Якщо `has_modifications = true`:
   - Залишити поточну логіку

### Catalog / CatalogSection

Оновити логіку отримання цін для фільтрів:
- Для простих товарів брати `product.price`
- Для товарів з модифікаціями брати `modifications[].price`

### FilterSidebar

Для простих товарів враховувати властивості з `product_property_values`, де можуть бути властивості з `applies_to = 'modification'`.

---

## Технічні деталі

### Міграція бази даних

```sql
ALTER TABLE products 
  ADD COLUMN has_modifications boolean DEFAULT true,
  ADD COLUMN price numeric DEFAULT NULL,
  ADD COLUMN old_price numeric DEFAULT NULL,
  ADD COLUMN sku varchar DEFAULT NULL,
  ADD COLUMN stock_quantity integer DEFAULT 0,
  ADD COLUMN is_in_stock boolean DEFAULT true;
```

### Компоненти для створення/оновлення

1. `src/pages/admin/ProductEdit.tsx` - основні зміни
2. `src/components/admin/SimpleProductFields.tsx` - новий компонент для полів простого товару  
3. `src/components/admin/AllProductProperties.tsx` - об'єднані властивості
4. `src/components/catalog/ProductCard.tsx` - підтримка простих товарів
5. `src/pages/ProductDetail.tsx` - підтримка простих товарів
6. `src/pages/Catalog.tsx` та `src/pages/CatalogSection.tsx` - оновити логіку фільтрів

### Послідовність реалізації

1. Міграція бази даних (додати нові колонки)
2. Оновити `ProductEdit.tsx` з перемикачем і умовним рендерингом
3. Створити компонент для полів простого товару
4. Оновити компонент властивостей для об'єднання обох рівнів
5. Оновити `ProductCard.tsx` для відображення цін
6. Оновити `ProductDetail.tsx` для простих товарів
7. Оновити каталоги для фільтрації за цінами
